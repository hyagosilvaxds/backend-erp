### üìä Testes de Exporta√ß√£o de Relat√≥rios Excel - Com Detalhamento

### Vari√°veis
@baseUrl = http://localhost:3000
@token = seu-token-jwt-aqui
@companyId = uuid-da-empresa

### ===========================================
### 1. Exportar Fluxo de Caixa (2 abas)
### ===========================================
GET {{baseUrl}}/financial/reports/cash-flow/export?companyId={{companyId}}&startDate=2024-01-01&endDate=2024-12-31
Authorization: Bearer {{token}}

### Resultado esperado:
### - Aba 1: "Fluxo de Caixa" com resumo di√°rio
### - Aba 2: "Lan√ßamentos Detalhados" com todas as transa√ß√µes

### ===========================================
### 2. Exportar Contas a Pagar (2 abas)
### ===========================================
GET {{baseUrl}}/financial/reports/accounts-payable/export?companyId={{companyId}}&startDate=2024-01-01&endDate=2024-12-31
Authorization: Bearer {{token}}

### Com filtro de status
GET {{baseUrl}}/financial/reports/accounts-payable/export?companyId={{companyId}}&status=PENDENTE
Authorization: Bearer {{token}}

### Resultado esperado:
### - Aba 1: "Contas a Pagar - Resumo"
### - Aba 2: "Detalhamento Completo" com todas as informa√ß√µes

### ===========================================
### 3. Exportar Contas a Receber (2 abas)
### ===========================================
GET {{baseUrl}}/financial/reports/accounts-receivable/export?companyId={{companyId}}&startDate=2024-01-01&endDate=2024-12-31
Authorization: Bearer {{token}}

### Com filtro de status
GET {{baseUrl}}/financial/reports/accounts-receivable/export?companyId={{companyId}}&status=VENCIDO
Authorization: Bearer {{token}}

### Resultado esperado:
### - Aba 1: "Contas a Receber - Resumo"
### - Aba 2: "Detalhamento Completo" com informa√ß√µes do cliente

### ===========================================
### 4. Exportar por Centro de Custo (2 abas)
### ===========================================
GET {{baseUrl}}/financial/reports/transactions/by-centro-custo/export?companyId={{companyId}}&startDate=2024-01-01&endDate=2024-12-31
Authorization: Bearer {{token}}

### Per√≠odo espec√≠fico
GET {{baseUrl}}/financial/reports/transactions/by-centro-custo/export?companyId={{companyId}}&startDate=2024-06-01&endDate=2024-06-30
Authorization: Bearer {{token}}

### Resultado esperado:
### - Aba 1: "Resumo por Centro de Custo"
### - Aba 2: "Todas as Transa√ß√µes" com detalhamento

### ===========================================
### 5. Exportar por Conta Cont√°bil (2 abas)
### ===========================================
GET {{baseUrl}}/financial/reports/transactions/by-conta-contabil/export?companyId={{companyId}}&startDate=2024-01-01&endDate=2024-12-31
Authorization: Bearer {{token}}

### Per√≠odo espec√≠fico
GET {{baseUrl}}/financial/reports/transactions/by-conta-contabil/export?companyId={{companyId}}&startDate=2024-Q1-01&endDate=2024-03-31
Authorization: Bearer {{token}}

### Resultado esperado:
### - Aba 1: "Resumo por Conta Cont√°bil"
### - Aba 2: "Todas as Transa√ß√µes" agrupadas

### ===========================================
### Valida√ß√µes a Fazer
### ===========================================

### ‚úÖ Verificar se o arquivo Excel tem 2 abas
### ‚úÖ Verificar formata√ß√£o de valores monet√°rios (R$ X.XXX,XX)
### ‚úÖ Verificar formata√ß√£o de datas (dd/mm/yyyy)
### ‚úÖ Verificar totais nas abas de resumo
### ‚úÖ Verificar que todos os campos est√£o presentes
### ‚úÖ Verificar que os dados das duas abas s√£o consistentes
### ‚úÖ Verificar informa√ß√µes de centro de custo e conta cont√°bil
### ‚úÖ Verificar informa√ß√µes de parcelas (1/3, 2/3, etc.)
### ‚úÖ Verificar status de concilia√ß√£o

### ===========================================
### Casos de Teste Espec√≠ficos
### ===========================================

### Teste 1: Per√≠odo sem transa√ß√µes
GET {{baseUrl}}/financial/reports/cash-flow/export?companyId={{companyId}}&startDate=2025-12-01&endDate=2025-12-31
Authorization: Bearer {{token}}
### Esperado: Arquivo com abas vazias mas com cabe√ßalhos

### Teste 2: Contas com parcelas
GET {{baseUrl}}/financial/reports/accounts-payable/export?companyId={{companyId}}&status=PENDENTE
Authorization: Bearer {{token}}
### Esperado: Coluna "Parcela" mostrando "1/3", "2/3", etc.

### Teste 3: Transa√ß√µes sem categoria
GET {{baseUrl}}/financial/reports/cash-flow/export?companyId={{companyId}}&startDate=2024-01-01&endDate=2024-12-31
Authorization: Bearer {{token}}
### Esperado: "Sem categoria" quando categoryId √© null

### Teste 4: Transa√ß√µes sem centro de custo
GET {{baseUrl}}/financial/reports/transactions/by-centro-custo/export?companyId={{companyId}}&startDate=2024-01-01&endDate=2024-12-31
Authorization: Bearer {{token}}
### Esperado: Grupo "Sem Centro de Custo" para transa√ß√µes sem centroCustoId

### Teste 5: Transa√ß√µes sem conta cont√°bil
GET {{baseUrl}}/financial/reports/transactions/by-conta-contabil/export?companyId={{companyId}}&startDate=2024-01-01&endDate=2024-12-31
Authorization: Bearer {{token}}
### Esperado: Grupo "Sem Conta Cont√°bil" para transa√ß√µes sem contaContabilId

### ===========================================
### Teste de Performance
### ===========================================

### Grande volume de dados (ano inteiro)
GET {{baseUrl}}/financial/reports/cash-flow/export?companyId={{companyId}}&startDate=2024-01-01&endDate=2024-12-31
Authorization: Bearer {{token}}
### Esperado: Resposta em menos de 5 segundos mesmo com 1000+ transa√ß√µes

### ===========================================
### Notas de Implementa√ß√£o
### ===========================================

### üìù Estrutura do Excel:
### - Cada relat√≥rio tem EXATAMENTE 2 abas
### - Aba 1: Sempre √© um resumo/agrega√ß√£o
### - Aba 2: Sempre √© o detalhamento completo
### 
### üìù Formata√ß√£o:
### - Cabe√ßalhos: Fundo azul (#FF4472C4), texto branco, negrito
### - Valores monet√°rios: R$ #,##0.00
### - Datas: dd/mm/yyyy
### - Totais: Linha final com f√≥rmulas SUM
###
### üìù Dados:
### - Todas as queries incluem relacionamentos necess√°rios
### - Valores null s√£o substitu√≠dos por "-" ou "Sem X"
### - Parcelas s√£o formatadas como "X/Y"
### - Concilia√ß√£o √© mostrada como "Sim"/"N√£o"
